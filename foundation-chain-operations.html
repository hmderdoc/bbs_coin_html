<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BBS Coin - foundation-chain-operations</title>
    <link rel="stylesheet" href="global.css">
</head>
<body>
    <div class="container">
        <p># Foundation Chain Operations (Multisig / Safe Runbook)</p>
<p>This document is **the practical, technical guide** for how the BBS Coin Foundation</p>
<p>actually operates contracts on-chain.</p>
<p>No DAO theory, no governance hype — just how adults run smart contracts with a multisig.</p>
<p>---</p>
<p>## 1. What “the Foundation” is on-chain</p>
<p>On-chain, **the Foundation is the Safe**.</p>
<p>There is no special Foundation contract, role, or magic address.</p>
<p>Whoever can execute transactions **from the Safe** controls Foundation authority.</p>
<p>Key implication:</p>
<ul>
<li>If the Safe owns `BbsTreasury`, then **only Safe-approved transactions** can:</li>
<li>mint tokens</li>
<li>deploy distributors</li>
<li>fund distributors</li>
<li>enable / disable distributors</li>
<li>perform emergency actions</li>
</ul>
<p>Everything else is off-chain process and human coordination.</p>
<p>---</p>
<p>## 2. Mental model: how multisig execution actually works</p>
<p>A Safe transaction has four real stages:</p>
<p>1. **Propose**</p>
<ul>
<li>One signer creates a transaction</li>
<li>Defines `to`, `value`, and `data`</li>
</ul>
<p>2. **Review**</p>
<ul>
<li>Other signers inspect the transaction details</li>
</ul>
<p>3. **Approve**</p>
<ul>
<li>Signers approve until quorum is met</li>
</ul>
<p>4. **Execute**</p>
<ul>
<li>One signer submits the transaction on-chain</li>
</ul>
<p>Important:</p>
<ul>
<li>Creating a transaction ≠ executing it</li>
<li>Approving ≠ executing</li>
<li>Nothing happens on-chain until execution</li>
</ul>
<p>---</p>
<p>## 3. What the Foundation actually does (and does not do)</p>
<p>### Foundation DOES</p>
<ul>
<li>Own and operate `BbsTreasury`</li>
<li>Mint tokens into Treasury</li>
<li>Deploy distributor contracts</li>
<li>Fund distributor contracts</li>
<li>Enable / disable distributors</li>
<li>Recover funds in emergencies</li>
</ul>
<p>### Foundation DOES NOT</p>
<ul>
<li>Publish Merkle epochs</li>
<li>Generate Merkle trees</li>
<li>Handle user claims</li>
<li>Manage BBS integrations</li>
<li>Decide how sysops calculate rewards</li>
</ul>
<p>Those responsibilities belong to sysops and their tooling.</p>
<p>---</p>
<p>## 4. Transactions vs call data (critical distinction)</p>
<p>A **transaction** is:</p>
<ul>
<li>`to` address</li>
<li>`value` (usually 0)</li>
<li>`data` (ABI-encoded function call)</li>
</ul>
<p>**Call data** is just the encoded function call.</p>
<p>Safe executes transactions — not “functions”.</p>
<p>You must always know:</p>
<ul>
<li>what contract you are calling</li>
<li>which function</li>
<li>with what parameters</li>
<li>what state change that causes</li>
</ul>
<p>---</p>
<p>## 5. How the Foundation generates call data</p>
<p>There are two supported paths.</p>
<p>### Option A: Safe UI (simplest)</p>
<p>Use Safe’s **Contract Interaction** feature:</p>
<ul>
<li>Paste or select contract ABI</li>
<li>Choose function</li>
<li>Enter parameters</li>
<li>Safe builds the call data</li>
</ul>
<p>Pros:</p>
<ul>
<li>No scripting</li>
<li>Harder to screw up encoding</li>
</ul>
<p>Cons:</p>
<ul>
<li>Manual</li>
<li>Slower at scale</li>
</ul>
<p>---</p>
<p>### Option B: Generate call data with scripts (recommended long-term)</p>
<p>Use `ethers` to generate call data locally, then paste into Safe.</p>
<p>Example pattern:</p>
<p>```ts</p>
<p>import { ethers } from "ethers";</p>
<p>const abi = [</p>
<p>"function fundDistributor(address distributor, uint256 amount)"</p>
<p>];</p>
<p>const iface = new ethers.Interface(abi);</p>
<p>const data = iface.encodeFunctionData(</p>
<p>"fundDistributor",</p>
<p>["0xDistributor", 500n * 10n**18n]</p>
<p>);</p>
<p>console.log(data);</p>
<p>```</p>
<p>Safe inputs:</p>
<ul>
<li>to: `BbsTreasury` address</li>
<li>value: `0`</li>
<li>data: output from script</li>
</ul>
<p>Pros:</p>
<ul>
<li>Auditable</li>
<li>Repeatable</li>
<li>Commit scripts to Git</li>
</ul>
<p>---</p>
<p>## 6. Concrete Foundation operations (tied to your contracts)</p>
<p>Below are **real actions** the Foundation will take, mapped directly to Solidity.</p>
<p>---</p>
<p>### 6.1 Set token on Treasury (one-time)</p>
<p>Contract:</p>
<ul>
<li>`BbsTreasury`</li>
</ul>
<p>Function:</p>
<p>```solidity</p>
<p>function setToken(address token_)</p>
<p>```</p>
<p>When:</p>
<ul>
<li>After deploying `BbsToken`</li>
</ul>
<p>Safe transaction:</p>
<ul>
<li>to: `BbsTreasury`</li>
<li>value: `0`</li>
<li>data: `setToken(tokenAddress)`</li>
</ul>
<p>Failure conditions:</p>
<ul>
<li>Reverts if already set</li>
</ul>
<p>---</p>
<p>### 6.2 Grant MINTER_ROLE to Treasury (one-time)</p>
<p>Contract:</p>
<ul>
<li>`BbsToken`</li>
</ul>
<p>Functions:</p>
<p>```solidity</p>
<p>function MINTER_ROLE() external view returns (bytes32)</p>
<p>function grantRole(bytes32 role, address account)</p>
<p>```</p>
<p>When:</p>
<ul>
<li>After Treasury deployment</li>
<li>Before minting</li>
</ul>
<p>Effect:</p>
<ul>
<li>Allows Treasury to mint tokens</li>
</ul>
<p>---</p>
<p>### 6.3 Mint tokens to Treasury</p>
<p>Contract:</p>
<ul>
<li>`BbsTreasury`</li>
</ul>
<p>Function:</p>
<p>```solidity</p>
<p>function mintToTreasury(uint256 amount)</p>
<p>```</p>
<p>When:</p>
<ul>
<li>Treasury needs supply to fund distributors</li>
</ul>
<p>Important:</p>
<ul>
<li>`amount` is in base units (18 decimals)</li>
</ul>
<p>---</p>
<p>### 6.4 Deploy a distributor (sysop onboarding)</p>
<p>Contract:</p>
<ul>
<li>`BbsTreasury`</li>
</ul>
<p>Function:</p>
<p>```solidity</p>
<p>function deployDistributor(</p>
<p>address sysopOwner,</p>
<p>string bbsId,</p>
<p>string metadataURI</p>
<p>)</p>
<p>```</p>
<p>What this does:</p>
<ul>
<li>Deploys `BbsMerkleDistributor`</li>
<li>Registers it in `DistributorRegistry`</li>
<li>Enables it for funding</li>
</ul>
<p>Output:</p>
<ul>
<li>Distributor address emitted in `DistributorDeployed` event</li>
</ul>
<p>---</p>
<p>### 6.5 Fund a distributor</p>
<p>Contract:</p>
<ul>
<li>`BbsTreasury`</li>
</ul>
<p>Function:</p>
<p>```solidity</p>
<p>function fundDistributor(address distributor, uint256 amount)</p>
<p>```</p>
<p>Checks:</p>
<ul>
<li>Distributor must be enabled</li>
<li>Treasury must have sufficient balance</li>
</ul>
<p>---</p>
<p>### 6.6 Disable or re-enable a distributor</p>
<p>Contract:</p>
<ul>
<li>`BbsTreasury`</li>
</ul>
<p>Function:</p>
<p>```solidity</p>
<p>function setDistributorEnabled(address distributor, bool enabled)</p>
<p>```</p>
<p>Use cases:</p>
<ul>
<li>Sysop key compromised</li>
<li>Abuse</li>
<li>Temporary suspension</li>
</ul>
<p>---</p>
<p>### 6.7 Emergency recovery (optional)</p>
<p>Contract:</p>
<ul>
<li>`BbsTreasury` → `BbsMerkleDistributor`</li>
</ul>
<p>Function chain:</p>
<p>```solidity</p>
<p>BbsTreasury.revokeFromDistributor(...)</p>
<p>→ BbsMerkleDistributor.revokeToTreasury(...)</p>
<p>```</p>
<p>Purpose:</p>
<ul>
<li>Pull unclaimed tokens back to Treasury</li>
</ul>
<p>---</p>
<p>## 7. Safe execution checklist (do this every time)</p>
<p>Before approving a Safe transaction:</p>
<ul>
<li>[ ] Correct chain (Polygon vs testnet)</li>
<li>[ ] `to` address matches canonical contract</li>
<li>[ ] `value == 0`</li>
<li>[ ] Function name and params correct</li>
<li>[ ] Amounts use base units (18 decimals)</li>
<li>[ ] Action matches Foundation intent</li>
<li>[ ] Sysop address verified (for deploys)</li>
</ul>
<p>If any box is unchecked, do not approve.</p>
<p>---</p>
<p>## 8. Separation of responsibilities (burn this in)</p>
<ul>
<li>**Foundation**</li>
<li>Controls supply</li>
<li>Controls distributors</li>
<li>Provides funding</li>
<li>**Sysop**</li>
<li>Publishes epochs</li>
<li>Generates Merkle trees</li>
<li>Operates BBS integration</li>
<li>**User**</li>
<li>Claims tokens</li>
<li>Owns wallet</li>
</ul>
<p>If these blur, bugs and blame follow.</p>
<p>---</p>
<p>## 9. Operational record keeping (not optional)</p>
<p>Maintain a simple log per chain:</p>
<ul>
<li>Date</li>
<li>Safe tx ID</li>
<li>On-chain tx hash</li>
<li>Operation type</li>
<li>Parameters</li>
<li>Link to explorer</li>
<li>Notes</li>
</ul>
<p>This matters more than clever tooling.</p>
<p>---</p>
<p>## 10. Final principle</p>
<p>The Safe is not a convenience.</p>
<p>It is the *constitution* of the Foundation.</p>
<p>If it’s not executed by the Safe,</p>
<p>it didn’t happen.</p>
        <hr>
        <p><a href="index.html">← Back to Index</a></p>
    </div>
</body>
</html>